<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quản Lý Sinh Viên</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    .tabs {
      display: flex;
      border-bottom: 2px solid #ccc;
      margin-bottom: 10px;
    }

    .tabs button {
      flex: 1;
      padding: 10px;
      border: none;
      cursor: pointer;
      background: #f1f1f1;
      font-size: 16px;
    }

    .tabs button.active {
      background: #fff;
      border-bottom: 2px solid #000;
      font-weight: bold;
    }

    .tabcontent {
      display: none;
    }

    .tabcontent.active {
      display: block;
    }

    table {
      border-collapse: collapse;
      width: 100%;
    }

    th,
    td {
      padding: 6px;
      border: 1px solid #ccc;
      text-align: center;
    }

    .inp {
      padding: 5px;
      width: 95%;
    }

    .btn input {
      padding: 8px 12px;
      border: none;
      border-radius: 4px;
      background-color: #4caf50;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1 style="text-align:center;">Quản Lý Sinh Viên</h1>

    <!-- Tab menu -->
    <div class="tabs">
      <button class="tablink active" onclick= "openTab(event, 'tab1')">Nhập thông tin</button>
      <button class="tablink" onclick="openTab(event, 'tab2')">Danh sách sinh viên</button>
    </div>

    <!-- Tab 1: Nhập thông tin -->
    <div id="tab1" class="tabcontent active">
      <form class="qlSinhVien" id="themsinhvien">
        <table>
          <tr>
            <td>Mã số sinh viên: </td>
            <td><input class="inp" type="text" id="mssv" required></td>
          </tr>
          <tr>
            <td>Họ và tên: </td>
            <td><input class="inp" type="text" id="hoten" required></td>
          </tr>
          <tr>
            <td>Chuyên ngành:</td>
            <td><select id="chuyennganh" required>
                <option value="">Chọn chuyên ngành</option>
                <option value="Công nghệ thông tin">Công nghệ thông tin</option>
                <option value="Khoa học máy tính">Khoa học máy tính</option>
                <option value="Quản trị kinh doanh">Quản trị kinh doanh</option>
                <option value="Marketing">Marketing</option>
                <option value="Logistics">Logistics</option>
              </select></td>
          </tr>
          <tr>
            <td>Ngày sinh: </td>
            <td><input class="inp" type="date" id="ngaysinh" required></td>
          </tr>
          <tr>
            <td>Quê quán: </td>
            <td><input class="inp" type="text" id="quequan" required></td>
          </tr>
          <tr>
            <td>Email: </td>
            <td><input class="inp" type="text" id="email" required pattern="^[^@\s]+@[^@\s]+\.[^@\s]+$"
                title="Email phải có @ và đúng định dạng"></td>
          </tr>
          <tr>
            <td>Số điện thoại: </td>
            <td><input class="inp" type="text" id="sdt" required pattern="^[0-9]{10,11}$"
                title="Số điện thoại từ 10-11 chữ số"></td>
          </tr>
          <tr>
            <td>Giới tính: </td>
            <td>
              <input type="radio" name="gioitinh" value="Nam" required>Nam
              <input type="radio" name="gioitinh" value="Nữ">Nữ
            </td>
          </tr>
        </table>
        <div class="btn">
          <input type="submit" value="Thêm sinh viên" style="color: white; background: green;">
          <input type="reset" value="Huỷ" style="background: rgb(226, 67, 67); color: white;">
        </div>
      </form>
    </div>

    <!-- Tab 2: Danh sách sinh viên -->
    <div id="tab2" class="tabcontent">
      <h2>Danh sách sinh viên</h2>
      <div style="margin-bottom: 10px;">
        <input class="inp" type="text" id="timkiem" placeholder="Tìm sinh viên...">
      </div>
      <table id="bangsinhvien">
        <thead>
          <tr>
            <th>MSSV</th>
            <th>Họ tên</th>
            <th>Chuyên ngành</th>
            <th>Ngày sinh</th>
            <th>Quê quán</th>
            <th>Email</th>
            <th>SĐT</th>
            <th>Giới tính</th>
            <th>Hành động</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    // Hàm chuyển tab
    function openTab(evt, tabName) {
      document.querySelectorAll(".tabcontent").forEach(t => t.classList.remove("active"));
      document.querySelectorAll(".tablink").forEach(b => b.classList.remove("active"));
      document.getElementById(tabName).classList.add("active");
      evt.currentTarget.classList.add("active");
    }

    // --- Class SinhVien + JS CRUD ---
    class SinhVien {
      constructor(mssv, hoten, chuyennganh, ngaysinh, quequan, email, sdt, gioitinh) {
        this.mssv = mssv;
        this.hoten = hoten;
        this.chuyennganh = chuyennganh;
        this.ngaysinh = ngaysinh;
        this.quequan = quequan;
        this.email = email;
        this.sdt = sdt;
        this.gioitinh = gioitinh;
      }
      getMssv() { return this.mssv; }
      getHoten() { return this.hoten; }
      getChuyenNganh() { return this.chuyennganh; }
      getNgaySinh() { return this.ngaysinh; }
      getQueQuan() { return this.quequan; }
      getEmail() { return this.email; }
      getStd() { return this.sdt; }
      getGioiTinh() { return this.gioitinh; }
    }

    let danhSachSV = [];
    let editingIndex = -1;

    function hienThiSinhVien() {
      const tBody = document.querySelector('#bangsinhvien tbody');
      tBody.innerHTML = "";
      danhSachSV.forEach((sv, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
        <td>${sv.getMssv()}</td>
        <td>${sv.getHoten()}</td>
        <td>${sv.getChuyenNganh()}</td>
        <td>${sv.getNgaySinh()}</td>
        <td>${sv.getQueQuan()}</td>
        <td>${sv.getEmail()}</td>
        <td>${sv.getStd()}</td>
        <td>${sv.getGioiTinh()}</td>
        <td>
          <button onclick="suaSinhVien(${index})">Sửa</button>
          <button onclick="xoaSinhVien(${index})">Xoá</button>
        </td>`;
        tBody.appendChild(row);
      });
    }

    function themSinhVien(sv) {
      danhSachSV.push(sv);
      hienThiSinhVien();
    }

    function xoaSinhVien(index) {
      danhSachSV.splice(index, 1);
      hienThiSinhVien();
    }

    function suaSinhVien(index) {
      const sv = danhSachSV[index];
      editingIndex = index;
      document.getElementById('mssv').value = sv.getMssv();
      document.getElementById('hoten').value = sv.getHoten();
      document.getElementById('chuyennganh').value = sv.getChuyenNganh();
      document.getElementById('ngaysinh').value = sv.getNgaySinh();
      document.getElementById('quequan').value = sv.getQueQuan();
      document.getElementById('email').value = sv.getEmail();
      document.getElementById('sdt').value = sv.getStd();
      document.querySelector(`input[name='gioitinh'][value='${sv.getGioiTinh()}']`).checked = true;
      openTab({ currentTarget: document.querySelectorAll(".tablink")[0] }, 'tab1'); // chuyển về tab nhập
    }

    document.addEventListener("DOMContentLoaded", function () {
      const form = document.getElementById("themsinhvien");
      const timkiem = document.getElementById('timkiem');

      form.addEventListener("submit", function (e) {
        e.preventDefault();
        const mssv = document.getElementById('mssv').value.trim();
        const hoten = document.getElementById('hoten').value.trim();
        const chuyennganh = document.getElementById('chuyennganh').value;
        const ngaysinh = document.getElementById('ngaysinh').value.trim();
        const quequan = document.getElementById('quequan').value.trim();
        const email = document.getElementById('email').value.trim();
        const sdt = document.getElementById('sdt').value.trim();
        const gioitinh = document.querySelector('input[name="gioitinh"]:checked').value;

        const sv = new SinhVien(mssv, hoten, chuyennganh, ngaysinh, quequan, email, sdt, gioitinh);
        if (editingIndex === -1) {
          themSinhVien(sv);
        } else {
          danhSachSV[editingIndex] = sv;
          editingIndex = -1;
          hienThiSinhVien();
        }
        form.reset();
        openTab({ currentTarget: document.querySelectorAll(".tablink")[1] }, 'tab2'); // chuyển sang tab danh sách
      });

      timkiem.addEventListener('keyup', function () {
        const keyword = timkiem.value.toLowerCase();
        const rows = document.querySelectorAll('#bangsinhvien tbody tr');
        rows.forEach(row => {
          const mssv = row.cells[0].innerText.toLowerCase();
          const hoten = row.cells[1].innerText.toLowerCase();
          row.style.display = (mssv.includes(keyword) || hoten.includes(keyword)) ? '' : 'none';
        });
      });
    });
  </script>
</body>

</html>